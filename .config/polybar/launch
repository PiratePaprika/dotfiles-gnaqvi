#!/bin/bash

# Generate config
$HOME/.local/bin/themer --app-config $XDG_CONFIG_HOME/polybar/config.template

# Load monitors info if not loaded already
[ -z "$PM_NAME" ] && . $HOME/.local/bin/moninfo

# Terminate already running polybar instances
killall -q polybar

# Wait until the processes have been shut down
while pgrep -u $UID -x polybar >/dev/null; do sleep 1; done

# Launch bars
polybar top &
polybar bottom &
[ ! -z "$LM_NAME" ] && polybar left &
[ ! -z "$RM_NAME" ] && polybar right &
